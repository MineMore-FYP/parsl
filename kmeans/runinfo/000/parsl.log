2019-11-07 12:07:48.623 parsl.dataflow.dflow:83 [DEBUG]  Starting DataFlowKernel with config
Config(
    app_cache=True, 
    checkpoint_files=None, 
    checkpoint_mode=None, 
    checkpoint_period=None, 
    data_management_max_threads=10, 
    executors=[ThreadPoolExecutor(
        label='threads', 
        managed=True, 
        max_threads=2, 
        storage_access=None, 
        thread_name_prefix='', 
        working_dir=None
    )], 
    initialize_logging=True, 
    lazy_errors=True, 
    max_idletime=120.0, 
    monitoring=None, 
    retries=0, 
    run_dir='runinfo', 
    strategy='simple', 
    usage_tracking=False
)
2019-11-07 12:07:48.623 parsl.dataflow.dflow:84 [INFO]  Parsl version: 0.9.0
2019-11-07 12:07:48.623 parsl.dataflow.usage_tracking.usage:126 [DEBUG]  Tracking status: False
2019-11-07 12:07:48.623 parsl.dataflow.usage_tracking.usage:127 [DEBUG]  Testing mode   : False
2019-11-07 12:07:48.623 parsl.dataflow.dflow:110 [INFO]  Run id is: 1d64f655-5ca8-4624-af80-62909a606344
2019-11-07 12:07:48.717 parsl.dataflow.memoization:52 [INFO]  App caching initialized
2019-11-07 12:07:48.718 parsl.dataflow.strategy:125 [DEBUG]  Scaling strategy: simple
2019-11-07 12:07:48.724 parsl.dataflow.dflow:484 [DEBUG]  Adding output dependencies
2019-11-07 12:07:48.724 parsl.dataflow.dflow:708 [INFO]  Task 0 submitted for App kmeans, waiting on tasks []
2019-11-07 12:07:48.724 parsl.dataflow.dflow:714 [DEBUG]  Task 0 set to pending state with AppFuture: <AppFuture super=<AppFuture at 0x7f04de69b668 state=pending>>
2019-11-07 12:07:48.725 parsl.dataflow.dflow:452 [INFO]  Task 0 launched on executor threads
2019-11-07 12:07:48.729 parsl.dataflow.dflow:484 [DEBUG]  Adding output dependencies
2019-11-07 12:07:48.729 parsl.dataflow.dflow:708 [INFO]  Task 1 submitted for App kmeans, waiting on tasks []
2019-11-07 12:07:48.729 parsl.dataflow.dflow:714 [DEBUG]  Task 1 set to pending state with AppFuture: <AppFuture super=<AppFuture at 0x7f04de69bbe0 state=pending>>
2019-11-07 12:07:48.729 parsl.dataflow.dflow:452 [INFO]  Task 1 launched on executor threads
2019-11-07 12:07:48.734 parsl.dataflow.dflow:484 [DEBUG]  Adding output dependencies
2019-11-07 12:07:48.735 parsl.dataflow.dflow:708 [INFO]  Task 2 submitted for App kmeans, waiting on tasks []
2019-11-07 12:07:48.739 parsl.dataflow.dflow:714 [DEBUG]  Task 2 set to pending state with AppFuture: <AppFuture super=<AppFuture at 0x7f04de6b0be0 state=pending>>
2019-11-07 12:07:48.739 parsl.dataflow.dflow:452 [INFO]  Task 2 launched on executor threads
2019-11-07 12:07:48.739 parsl.dataflow.dflow:484 [DEBUG]  Adding output dependencies
2019-11-07 12:07:48.739 parsl.dataflow.dflow:708 [INFO]  Task 3 submitted for App kmeans, waiting on tasks []
2019-11-07 12:07:48.739 parsl.dataflow.dflow:714 [DEBUG]  Task 3 set to pending state with AppFuture: <AppFuture super=<AppFuture at 0x7f04de6b0748 state=pending>>
2019-11-07 12:07:48.740 parsl.dataflow.dflow:452 [INFO]  Task 3 launched on executor threads
2019-11-07 12:07:48.740 parsl.dataflow.dflow:484 [DEBUG]  Adding output dependencies
2019-11-07 12:07:48.743 parsl.dataflow.dflow:708 [INFO]  Task 4 submitted for App kmeans, waiting on tasks []
2019-11-07 12:07:48.744 parsl.dataflow.dflow:714 [DEBUG]  Task 4 set to pending state with AppFuture: <AppFuture super=<AppFuture at 0x7f04de6b05f8 state=pending>>
2019-11-07 12:07:48.744 parsl.dataflow.dflow:452 [INFO]  Task 4 launched on executor threads
2019-11-07 12:07:48.747 parsl.dataflow.dflow:484 [DEBUG]  Adding output dependencies
2019-11-07 12:07:48.748 parsl.dataflow.dflow:708 [INFO]  Task 5 submitted for App kmeans, waiting on tasks []
2019-11-07 12:07:48.749 parsl.dataflow.dflow:714 [DEBUG]  Task 5 set to pending state with AppFuture: <AppFuture super=<AppFuture at 0x7f04de6b0438 state=pending>>
2019-11-07 12:07:48.749 parsl.dataflow.dflow:452 [INFO]  Task 5 launched on executor threads
2019-11-07 12:07:49.080 parsl.app.errors:158 [DEBUG]  Reraising exception of type <class 'NameError'>
2019-11-07 12:07:49.080 parsl.dataflow.dflow:257 [DEBUG]  Task 0 failed
2019-11-07 12:07:49.080 parsl.dataflow.dflow:279 [ERROR]  Task 0 failed after 0 retry attempts
Traceback (most recent call last):
  File "/home/kalpani/.local/lib/python3.5/site-packages/parsl/dataflow/dflow.py", line 254, in handle_exec_update
    res.reraise()
  File "/home/kalpani/.local/lib/python3.5/site-packages/parsl/app/errors.py", line 163, in reraise
    reraise(t, v, tb)
  File "/home/kalpani/.local/lib/python3.5/site-packages/six.py", line 692, in reraise
    raise value.with_traceback(tb)
  File "/home/kalpani/.local/lib/python3.5/site-packages/parsl/app/errors.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "threaddf.py", line 42, in kmeans
    plt.ylabel(j)
NameError: name 'j' is not defined
2019-11-07 12:07:49.081 parsl.app.errors:158 [DEBUG]  Reraising exception of type <class 'NameError'>
2019-11-07 12:07:49.124 parsl.app.errors:158 [DEBUG]  Reraising exception of type <class 'NameError'>
2019-11-07 12:07:49.124 parsl.dataflow.dflow:257 [DEBUG]  Task 2 failed
2019-11-07 12:07:49.125 parsl.dataflow.dflow:279 [ERROR]  Task 2 failed after 0 retry attempts
Traceback (most recent call last):
  File "/home/kalpani/.local/lib/python3.5/site-packages/parsl/dataflow/dflow.py", line 254, in handle_exec_update
    res.reraise()
  File "/home/kalpani/.local/lib/python3.5/site-packages/parsl/app/errors.py", line 163, in reraise
    reraise(t, v, tb)
  File "/home/kalpani/.local/lib/python3.5/site-packages/six.py", line 692, in reraise
    raise value.with_traceback(tb)
  File "/home/kalpani/.local/lib/python3.5/site-packages/parsl/app/errors.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "threaddf.py", line 42, in kmeans
    plt.ylabel(j)
NameError: name 'j' is not defined
2019-11-07 12:07:49.125 parsl.app.errors:158 [DEBUG]  Reraising exception of type <class 'NameError'>
2019-11-07 12:07:49.142 parsl.dataflow.dflow:864 [INFO]  DFK cleanup initiated
2019-11-07 12:07:49.142 parsl.dataflow.dflow:750 [INFO]  Summary of tasks in DFK:
2019-11-07 12:07:49.142 parsl.dataflow.dflow:781 [INFO]  Tasks in state States.failed: 0, 2
2019-11-07 12:07:49.142 parsl.dataflow.dflow:781 [INFO]  Tasks in state States.launched: 1, 3, 4, 5
2019-11-07 12:07:49.142 parsl.dataflow.dflow:788 [INFO]  End of summary
2019-11-07 12:07:49.143 parsl.dataflow.dflow:888 [INFO]  Terminating flow_control and strategy threads
2019-11-07 12:07:49.143 parsl.executors.threads:96 [DEBUG]  Done with executor shutdown
2019-11-07 12:07:49.143 parsl.executors.threads:96 [DEBUG]  Done with executor shutdown
2019-11-07 12:07:49.143 parsl.dataflow.dflow:920 [INFO]  DFK cleanup complete
2019-11-07 12:07:49.177 parsl.app.errors:158 [DEBUG]  Reraising exception of type <class 'NameError'>
2019-11-07 12:07:49.178 parsl.dataflow.dflow:257 [DEBUG]  Task 3 failed
2019-11-07 12:07:49.178 parsl.dataflow.dflow:279 [ERROR]  Task 3 failed after 0 retry attempts
Traceback (most recent call last):
  File "/home/kalpani/.local/lib/python3.5/site-packages/parsl/dataflow/dflow.py", line 254, in handle_exec_update
    res.reraise()
  File "/home/kalpani/.local/lib/python3.5/site-packages/parsl/app/errors.py", line 163, in reraise
    reraise(t, v, tb)
  File "/home/kalpani/.local/lib/python3.5/site-packages/six.py", line 692, in reraise
    raise value.with_traceback(tb)
  File "/home/kalpani/.local/lib/python3.5/site-packages/parsl/app/errors.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "threaddf.py", line 42, in kmeans
    plt.ylabel(j)
NameError: name 'j' is not defined
2019-11-07 12:07:49.178 parsl.app.errors:158 [DEBUG]  Reraising exception of type <class 'NameError'>
2019-11-07 12:07:49.215 parsl.app.errors:158 [DEBUG]  Reraising exception of type <class 'NameError'>
2019-11-07 12:07:49.215 parsl.dataflow.dflow:257 [DEBUG]  Task 4 failed
2019-11-07 12:07:49.215 parsl.dataflow.dflow:279 [ERROR]  Task 4 failed after 0 retry attempts
Traceback (most recent call last):
  File "/home/kalpani/.local/lib/python3.5/site-packages/parsl/dataflow/dflow.py", line 254, in handle_exec_update
    res.reraise()
  File "/home/kalpani/.local/lib/python3.5/site-packages/parsl/app/errors.py", line 163, in reraise
    reraise(t, v, tb)
  File "/home/kalpani/.local/lib/python3.5/site-packages/six.py", line 692, in reraise
    raise value.with_traceback(tb)
  File "/home/kalpani/.local/lib/python3.5/site-packages/parsl/app/errors.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "threaddf.py", line 42, in kmeans
    plt.ylabel(j)
NameError: name 'j' is not defined
2019-11-07 12:07:49.216 parsl.app.errors:158 [DEBUG]  Reraising exception of type <class 'NameError'>
2019-11-07 12:07:49.251 parsl.app.errors:158 [DEBUG]  Reraising exception of type <class 'NameError'>
2019-11-07 12:07:49.252 parsl.dataflow.dflow:257 [DEBUG]  Task 5 failed
2019-11-07 12:07:49.252 parsl.dataflow.dflow:279 [ERROR]  Task 5 failed after 0 retry attempts
Traceback (most recent call last):
  File "/home/kalpani/.local/lib/python3.5/site-packages/parsl/dataflow/dflow.py", line 254, in handle_exec_update
    res.reraise()
  File "/home/kalpani/.local/lib/python3.5/site-packages/parsl/app/errors.py", line 163, in reraise
    reraise(t, v, tb)
  File "/home/kalpani/.local/lib/python3.5/site-packages/six.py", line 692, in reraise
    raise value.with_traceback(tb)
  File "/home/kalpani/.local/lib/python3.5/site-packages/parsl/app/errors.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "threaddf.py", line 42, in kmeans
    plt.ylabel(j)
NameError: name 'j' is not defined
2019-11-07 12:07:49.252 parsl.app.errors:158 [DEBUG]  Reraising exception of type <class 'NameError'>
2019-11-07 12:07:50.030 parsl.app.errors:158 [DEBUG]  Reraising exception of type <class 'RuntimeError'>
2019-11-07 12:07:50.033 parsl.dataflow.dflow:257 [DEBUG]  Task 1 failed
2019-11-07 12:07:50.033 parsl.dataflow.dflow:279 [ERROR]  Task 1 failed after 0 retry attempts
Traceback (most recent call last):
  File "/home/kalpani/.local/lib/python3.5/site-packages/parsl/dataflow/dflow.py", line 254, in handle_exec_update
    res.reraise()
  File "/home/kalpani/.local/lib/python3.5/site-packages/parsl/app/errors.py", line 163, in reraise
    reraise(t, v, tb)
  File "/home/kalpani/.local/lib/python3.5/site-packages/six.py", line 692, in reraise
    raise value.with_traceback(tb)
  File "/home/kalpani/.local/lib/python3.5/site-packages/parsl/app/errors.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "threaddf.py", line 40, in kmeans
    plt.scatter(X[:,0], X[:,1], c= kmeans.labels_, cmap='rainbow')
  File "/usr/lib/python3/dist-packages/matplotlib/pyplot.py", line 3241, in scatter
    ax = gca()
  File "/usr/lib/python3/dist-packages/matplotlib/pyplot.py", line 928, in gca
    return gcf().gca(**kwargs)
  File "/usr/lib/python3/dist-packages/matplotlib/pyplot.py", line 578, in gcf
    return figure()
  File "/usr/lib/python3/dist-packages/matplotlib/pyplot.py", line 527, in figure
    **kwargs)
  File "/usr/lib/python3/dist-packages/matplotlib/backends/backend_tkagg.py", line 84, in new_figure_manager
    return new_figure_manager_given_figure(num, figure)
  File "/usr/lib/python3/dist-packages/matplotlib/backends/backend_tkagg.py", line 101, in new_figure_manager_given_figure
    icon_img = Tk.PhotoImage(file=icon_fname)
  File "/usr/lib/python3.5/tkinter/__init__.py", line 3397, in __init__
    Image.__init__(self, 'photo', name, cnf, master, **kw)
  File "/usr/lib/python3.5/tkinter/__init__.py", line 3353, in __init__
    self.tk.call(('image', 'create', imgtype, name,) + options)
RuntimeError: main thread is not in main loop
2019-11-07 12:07:50.040 parsl.app.errors:158 [DEBUG]  Reraising exception of type <class 'RuntimeError'>
